---
layout: default
title: Malware Characterization
nav_order: 3
has_children: false
permalink: /docs/malwarecharacterization
---

# Malware Characterization
---

## Overview

We used five high-level categories to describe the characteristics of the analyzed Google Play malware: 

![](../img/characteristic_overview.svg)

---

## Malware Event Conditions

![](../img/characteristic_eventconditions.svg)

System Events
* Boot Events - Triggered based on the device boot status (e.g., cold boot, restart, reboot)
* Device Status - Triggered on the device screen status (e.g., screen on/off, device unlocked, wake up screen saver)
* Network Status - Triggered on network status (e.g., connection change, wifi state change)
* Developer-Defined - Triggered on non-Android defined intents (e.g., push notifications from Firebase messaging services)
* Package Changes - Triggered on package related events (e.g., installing an app, removing an app)
* Service Bind - Triggered on bound services (e.g., accessibility, notification listeners) 
* SMS Events - Triggered on SMS events (e.g., SMS received, sent, WAP billing performed)
* Battery Events - Triggered on battery status (e.g., battery level changes, charging status changes)
* Call Events - Triggered on call status (e.g., receiving a call, phone state change)
* USB Status - Triggered on USB events (e.g., USB connectivity)

User Events
* Application Launch - Triggered when the user launches the app
* Button Click - Triggered when the user interacts with a button on the app
* Sensitive Input - Triggered when the user inputs sensitive information into UI elements of the app
* Permissions - Triggered when the user grants an app permissions
* App Install - Triggered when the user installs an app
* Clipboard Text - Triggered when the user copies text to the clipboard

Scheduling Events
* Triggered by scheduling an alarm or handler that executes periodically

---

## Malware Check Conditions

![](../img/characteristic_checkconditions.svg)

External Server
* SMS - Checking based on command retrieved from SMS
* Internet - Checking based on commands retrieved from the internet

Device
* Sensor - Checking data from sensors (e.g., battery, temperature, motion sensors)
* Hardware Specifications - Checking hardware specifications of the device (e.g., CPU, screen status, network operator, etc.)
* Software Specifications - Checking software specifications of device (e.g., Android version, apps installed on device, emulator indicators, current phone state, device rooted, etc.)
* Network - Checking network status of the device

Environment
* Location - Checking based on specific location
* Time - Checking based on specific time

Application
* Permission - Checking if the app is provided with permissions
* Data Format - Checking for a specific data format (e.g., phone number, PIN number, wallet address, image format, etc.)
* Probability - Checking based on a probability roll (e.g., rolling a random number between 1-100 and checking it is less than 25)
* Install Referrer - Checking if the app was installed under a specific install referrer (e.g., clicky, azuvu)
* App Version - Checking if the app is a certain version

---

## Malware Payloads

![](../img/characteristic_payloads.svg)

* Information Stealing - Stealing information from the user (e.g., device, bank/social/entertainment accounts, content specific to the user)
* Ad Abuse - Abusing advertisement schemes for monetary value
* Premium Charges - Subscribe the device to premium charges (e.g., premium SMS, premium rate numbers, WAP billing)
* Cryptocurrency Mining - Mining cryptocurrency without the users consent
* Root Exploit - Granting elevated access to perform unauthorized actions
* Clipboard Hijacking - Replacing the text of the user's copy action to perform unintentional actions (e.g., replace copied text with malware developers cryptocurrency wallet) 
* Port Forwarding - Gain access to the users internal network
* Ransom - Disable device functionalities to coerce victim into paying a fee to re-enable the device
* Unknown - Payloads which download an unknown malicious executable
 
---


## Hiding Techniques

![](../img/characteristic_hidingtechniques.svg)

* Icon Manipulation - Changes to the icon to deter attention from the user (e.g., hiding the icon, changing icon to something user would not normally uninstall)
* Rich Benign Functionality - Implementing functionalities that a user deems useful
* Device Admin - Granting device admin privileges to increase difficulty in uninstalling the application
* Information Blocking - Blocking information of malicious activities from the user (e.g., cancelling a notification, deleting an SMS message, etc.)
* Self-Uninstallation - Uninstalls itself to confuse the user on which app performed the malicious behavior
* Automated Gesture Input - Prevent the user from performing certain actions by performing automated gestures (e.g., pressing back button when the user is on an Antivirus app)
* Screen Locking - Hide malicious behaviors of application by locking the screen

---

## Coding Properties

![](../img/characteristic_codeproperties.svg)

Location
* Direct - Implementation includes code from source DEX files
* Hidden (Local) - Implementation includes code from local assets
* Downloaded (Remote) - Implementation include code downloaded from remote sources

Language
* Bytecode - Implementation found in Java bytecode
* Native - Implementation found in native code
* Web - Implementation found in HTML/CSS/JS

---

# Detailed Mapping of Samples

![](../img/malware_overview-1.svg)

![](../img/malware_overview-2.svg)

Both images can be downloaded at the following links: [Families A-G](../img/malware_overview-1.png), [Families H-Z](../img/malware_overview-2.png)
